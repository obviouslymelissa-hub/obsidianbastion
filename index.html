<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Obsidian Bastian â€” Command Hub</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root {
      --bg-dark: #0f1318;
      --bg-panel: #151821;
      --accent: #4fd1c5;
      --accent-2: #7ef0df;
      --text-main: #e6eef2;
      --text-muted: #9fb2bf;
      --border: #22272f;
      --tile-radius: 10px;
      --font-family: 'Segoe UI', 'Roboto', Arial, sans-serif;
      --header-height: 120px;
    }

    /* Page basics */
    html,body{height:100%;margin:0;font-family:var(--font-family);background:var(--bg-dark);color:var(--text-main)}
    /* Header with ship image placeholder */
    header {
      /* layered background for depth */
      background:
        radial-gradient(600px 120px at 10% 30%, rgba(127,240,223,0.06), transparent 8%),
        radial-gradient(500px 100px at 90% 60%, rgba(79,209,197,0.04), transparent 6%),
        linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));
      border-bottom: 2px solid rgba(79,209,197,0.12);
      padding: 18px;
      position:relative;
      overflow:visible;
    }
    /* soft animated glow behind header */
    header::before{
      content:"";
      position:absolute;
      inset:auto 8% -40px 8%;
      height:160px;
      z-index:0;
      background: radial-gradient(closest-side, rgba(79,209,197,0.06), transparent 45%);
      filter: blur(28px);
      transform: translateY(8px);
      pointer-events:none;
      opacity:0.9;
      transition:opacity .4s ease;
    }

    .header-inner {
      max-width:1200px;
      margin:0 auto;
      display:flex;
      align-items:center;
      gap:18px;
      justify-content:center;
      padding:6px 12px;
      position:relative;
      z-index:1;
      height: var(--header-height);
    }

    /* Emblem + ship frame */
    .emblem {
      width:76px;
      height:76px;
      flex:0 0 76px;
      display:flex;
      align-items:center;
      justify-content:center;
      border-radius:14px;
      background: linear-gradient(135deg, rgba(127,240,223,0.06), rgba(79,209,197,0.02));
      border:1px solid rgba(127,240,223,0.08);
      box-shadow: 0 6px 20px rgba(0,0,0,0.5), 0 0 30px rgba(79,209,197,0.02) inset;
    }
    .emblem svg { width:56px;height:56px;display:block; }

    .ship-img-wrap {
      width:96px;
      height:96px;
      border-radius:16px;
      background: linear-gradient(180deg, rgba(79,209,197,0.04), rgba(255,255,255,0.01));
      border: 1px solid rgba(255,255,255,0.04);
      box-shadow: 0 10px 30px rgba(0,0,0,0.6), 0 0 18px rgba(79,209,197,0.04) inset;
      overflow:hidden;
      transform-style:preserve-3d;
      perspective:800px;
      flex:0 0 96px;
      display:flex;
      align-items:center;
      justify-content:center;
      transition: transform .18s linear;
      position:relative;
    }
    .ship-img {
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
      transform-origin:center;
      transition: transform .28s cubic-bezier(.2,.9,.2,1);
    }

    /* subtle floating motion */
    @keyframes headerFloat {
      0% { transform: translateY(-3px); }
      50% { transform: translateY(3px); }
      100% { transform: translateY(-3px); }
    }
    .ship-img-wrap.floating { animation: headerFloat 6s ease-in-out infinite; }

    .header-text { text-align:left; }
    .header-text h1 {
      margin:0;
      font-size:1.6rem;
      color:var(--text-main);
      letter-spacing:1.6px;
      font-weight:800;
      display:inline-block;
      position:relative;
      line-height:1;
    }
    /* sheen effect on title */
    .header-text h1::before{
      content:"";
      position:absolute;
      inset:0;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.12), transparent);
      transform: translateX(-110%);
      transition: transform .9s ease;
      pointer-events:none;
      mix-blend-mode:screen;
    }
    .header-text h1.sheen::before{
      transform: translateX(110%);
    }
    .header-text p { margin:6px 0 0 0; color:var(--text-muted); font-size:0.95rem; max-width:520px }

    /* CTA styling tweaks */
    .about-actions a.btn { font-weight:800; letter-spacing:0.6px; }
    .about-actions a.btn.ghost {
      border:1px solid rgba(255,255,255,0.04);
      color:var(--text-main);
      background: linear-gradient(180deg, rgba(255,255,255,0.01), transparent);
    }

    /* Panels (unchanged) */
    .container {
      max-width:1200px;
      margin:20px auto;
      padding:0 18px 48px;
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 20px;
    }
    .about {
      grid-column: 1 / -1;
      background: linear-gradient(180deg, rgba(79,209,197,0.03), rgba(255,255,255,0.01));
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 18px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.45);
      display:flex;
      gap:18px;
      align-items:center;
      justify-content:space-between;
    }
    .about .about-text { max-width: 72%; }
    .about h3 { margin:0 0 6px 0;color:var(--accent);font-size:1.15rem }
    .about p { margin:0;color:var(--text-muted);line-height:1.45 }

    /* New formatting styles for the about content */
    .about-dl { margin:8px 0 12px 0; display:flex; gap:18px; flex-wrap:wrap; align-items:flex-start; }
    .about-dl dt { font-weight:700; color:var(--text-main); font-size:0.92rem; text-transform:uppercase; letter-spacing:0.9px; }
    .about-dl dd { margin:0; color:var(--text-muted); font-size:0.95rem; }
    .core-list { list-style: none; padding:0; margin:12px 0 0 0; display:block; }
    .core-list li { margin:10px 0; }
    .core-list strong { color:var(--accent); display:inline-block; min-width:140px; }

    .about .about-actions { display:flex; gap:10px; align-items:center }
    .about a.btn { text-decoration:none; }

    .panel {
      background: var(--bg-panel);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.35);
    }
    .panel h3 { margin:0 0 10px 0;color:var(--accent);font-size:1.15rem }

    /* Systems-dock / tile styling retained only for Onboard Computer link (simplified) */
    .systems-dock {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }
    .tile {
      background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
      border:1px solid var(--border);
      border-radius: var(--tile-radius);
      padding:12px;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      min-height:96px;
      transform-origin:center;
      transition: transform .16s ease, box-shadow .16s ease;
      will-change: transform;
      opacity: 0;
    }
    .tile.main {
      grid-column: 1 / -1;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 16px;
      padding: 18px;
      min-height:140px;
      opacity: 1;
    }
    .tile-head { display:flex; gap:12px; align-items:center }
    .tile-icon {
      width:48px;height:48px;border-radius:10px;background:rgba(79,209,197,0.06);display:flex;align-items:center;justify-content:center;font-size:20px;color:var(--accent)
    }
    .tile-title { font-weight:700; font-size:1rem }
    .tile-desc { color:var(--text-muted); font-size:0.9rem; margin-top:4px }

    .tile-actions { display:flex; gap:8px; align-items:center }
    .btn {
      background:var(--accent); color:var(--bg-panel); padding:8px 12px; border-radius:8px; text-decoration:none; font-weight:700; border:none; cursor:pointer;
    }
    .btn.ghost { background:transparent;color:var(--text-main); border:1px solid var(--border); padding:7px 10px; font-weight:600 }

    .tile:hover { transform: translateY(-6px) scale(1.03); box-shadow: 0 10px 30px rgba(0,0,0,0.45); }

    @keyframes floatUp { from { opacity: 0; transform: translateY(10px) scale(.996); } to { opacity:1; transform: none; } }
    .systems-dock .tile { animation: floatUp .36s ease both; }
    .systems-dock .tile:nth-child(1) { animation-delay: 0.02s; }

    .side-stack { display:flex; flex-direction:column; gap:12px }
    .small-list { list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:10px }
    .small-item { display:flex; gap:10px; align-items:flex-start }

    .thumb { width:56px;height:36px;border-radius:6px;background:rgba(255,255,255,0.02); object-fit:cover; }

    .gallery-grid {
      display:flex;
      gap:12px;
      flex-wrap:wrap;
      align-items:center;
    }

    .gallery-grid .thumb {
      width:200px;
      height:130px;
      object-fit:cover;
      border-radius:8px;
      border: 1px solid rgba(0,0,0,0.06);
      cursor:pointer;
      transition: transform .12s ease, box-shadow .12s ease;
      display:block;
    }
    .gallery-grid .thumb:focus,
    .gallery-grid .thumb:hover { transform: translateY(-6px); box-shadow: 0 8px 24px rgba(0,0,0,0.5); outline: none; }

    @media (min-width: 900px) {
      .gallery-grid .thumb { width:240px; height:156px; }
    }

    .lightbox {
      position:fixed;
      inset:0;
      background: rgba(0,0,0,0.85);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:1200;
      padding:24px;
    }
    .lightbox.open { display:flex; }

    .lb-content {
      max-width: 92vw;
      max-height: 82vh;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:12px;
    }
    .lb-content img {
      max-width: 100%;
      max-height: calc(82vh - 80px);
      object-fit:contain;
      border-radius:8px;
      box-shadow: 0 8px 40px rgba(0,0,0,0.6);
      background: #000;
    }
    .lb-caption {
      color:var(--text-muted);
      font-size:0.95rem;
      text-align:center;
      max-width:92vw;
    }

    .lb-close, .lb-prev, .lb-next {
      position:absolute;
      background:transparent;
      color:var(--text-main);
      border:0;
      font-size:28px;
      cursor:pointer;
      padding:12px;
      line-height:1;
    }
    .lb-close { top:18px; right:22px; font-size:30px; }
    .lb-prev { left:18px; top:50%; transform:translateY(-50%); }
    .lb-next { right:18px; top:50%; transform:translateY(-50%); }

    .lb-close:focus, .lb-prev:focus, .lb-next:focus { outline:2px solid rgba(79,209,197,0.28); border-radius:8px; }

    footer { text-align:center;color:var(--text-muted);padding:24px 0 40px;border-top:1px solid var(--border);margin-top:18px }

    /* Responsiveness */
    @media (max-width:1000px){
      .container { grid-template-columns: 1fr; padding-bottom:28px }
      .systems-dock { grid-template-columns: repeat(2, 1fr) }
      .tile.main { grid-column: 1 / -1; flex-direction:column; align-items:flex-start }
      .about { flex-direction:column; align-items:flex-start; gap:12px }
      .about .about-text { max-width:100% }
      .header-inner { justify-content:flex-start; }
      .header-text { text-align:left }
      .gallery-grid .thumb { width:160px; height:104px; }
      header::before { display:none; }
    }
    @media (max-width:600px){
      .systems-dock { grid-template-columns: 1fr }
      .ship-img { width:72px; height:72px; flex:0 0 72px; }
      .header-inner { gap:12px; padding:6px; }
      .header-text h1 { font-size:1.25rem; }
      .gallery-grid { justify-content:center; }
      .gallery-grid .thumb { width:140px; height:90px; }
      .emblem { display:none; }
      .ship-img-wrap { width:72px; height:72px; border-radius:12px; flex:0 0 72px; }
      .header-inner { height:84px; }
    }

    /* Respect reduced motion preference */
    @media (prefers-reduced-motion: reduce) {
      .ship-img-wrap.floating { animation: none; }
      .header-text h1::before { transition:none; transform:none; display:none; }
      .ship-img-wrap, .ship-img { transition: none; }
    }
  </style>
</head>
<body>
  <header>
    <div class="header-inner" role="banner" aria-label="Obsidian Bastian header">
      <!-- Inline emblem for stronger brand presence -->
      <div class="emblem" aria-hidden="true" title="Obsidian Bastian emblem">
        <!-- Simple ship emblem (SVG) -->
        <svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
          <defs>
            <linearGradient id="g1" x1="0" x2="1">
              <stop offset="0" stop-color="#7ef0df" stop-opacity="0.9"/>
              <stop offset="1" stop-color="#4fd1c5" stop-opacity="0.9"/>
            </linearGradient>
          </defs>
          <rect width="64" height="64" rx="10" fill="url(#g1)" opacity="0.08"/>
          <path d="M32 6L38 24L56 28L38 32L32 50L26 32L8 28L26 24L32 6Z" fill="#7ef0df" opacity="0.9"/>
          <circle cx="32" cy="32" r="6" fill="#0f1318" />
        </svg>
      </div>

      <!-- Replace the placeholder image at /images/ship-header.jpg with your ship photo -->
      <div class="ship-img-wrap floating" id="shipWrap" aria-hidden="false">
        <img class="ship-img" id="shipImg" src="https://obviouslymelissa-hub.github.io/obsidianbastian/images/ship-header.jpg" alt="Obsidian Bastian ship image placeholder">
      </div>

      <div class="header-text">
        <h1 id="siteTitle">Obsidian Bastian Command Hub</h1>
        <p id="siteTag">Centralized access for all crew operations and ship systems â€” hover tiles to reveal actions.</p>
      </div>
    </div>
  </header>

  <main class="container" aria-live="polite">
    <!-- ABOUT: full-width, top -->
    <section class="about" role="region" aria-labelledby="about-title">
      <div class="about-text">
        <h3 id="about-title">About the Obsidian Bastian</h3>

        <dl class="about-dl" aria-hidden="false">
          <div>
            <dt>Designation</dt>
            <dd>Exploration Cruiser</dd>
          </div>
          <div>
            <dt>Registry</dt>
            <dd>Active Service Vessel</dd>
          </div>
          <div>
            <dt>Status</dt>
            <dd>Ready for exploration, research, and defense operations</dd>
          </div>
          <div>
            <dt>Authority</dt>
            <dd>Command-certified Â· Mission-capable Â· Fleet-aligned</dd>
          </div>
        </dl>

        <p>
          The Obsidian Bastian is a long-range cruiser engineered for sustained deployment, operational resilience, and defensive readiness.
          Its systems are optimized for extended missions, combining strategic command facilities with reinforced crew accommodations.
        </p>

        <h4 style="margin:12px 0 6px 0;color:var(--text-main)">Core assets include:</h4>
        <ul class="core-list" aria-label="Core assets">
          <li><strong>Mission Control:</strong> Navigation, tactical oversight, and command relay.</li>
          <li><strong>Mainframe:</strong> Telemetry, communications, and data integrity.</li>
          <li><strong>Engineering Bay:</strong> Compact, modular repair hub for rapid response.</li>
          <li><strong>Onboard Computer:</strong> Continuous monitoring and system regulation.</li>
          <li><strong>Defense Systems:</strong> Integrated laser arrays and shielding protocols, ensuring combat readiness alongside exploration duties.</li>
        </ul>

        <p style="margin-top:12px;">
          Oversight is managed by the onboard computer, maintaining efficiency and readiness at all times.
        </p>
      </div>
      <div class="about-actions">
        <a class="btn" href="https://obviouslymelissa-hub.github.io/obsidianbastian/crew.html" aria-label="About and Crew">About &amp; Crew</a>
        <a class="btn ghost" href="https://obviouslymelissa-hub.github.io/obsidianbastian/onboardcomputer.html" aria-label="Open Onboard Computer">Open Console</a>
      </div>
    </section>

    <!-- LEFT: Systems Dock (now simplified â€” only the Onboard Computer tile remains) -->
    <section class="panel" aria-labelledby="systems-title">
      <h3 id="systems-title">Systems Dock</h3>

      <div class="systems-dock" role="list">
        <!-- Keep only the Onboard Computer link here so index remains light -->
        <div class="tile main" role="listitem" aria-label="Onboard Computer">
          <div style="display:flex;gap:14px;align-items:center;">
            <div class="tile-icon" aria-hidden="true">ðŸ’»</div>
            <div>
              <div class="tile-title">Onboard Computer</div>
              <div class="tile-desc">Primary control interface â€” main console, diagnostics, and mission controls.</div>
            </div>
          </div>
          <div class="tile-actions">
            <a class="btn" href="https://obviouslymelissa-hub.github.io/obsidianbastian/onboardcomputer.html" aria-label="Open Onboard Computer">Open</a>
            <a class="btn ghost" href="https://obviouslymelissa-hub.github.io/obsidianbastian/diagnostics.html" aria-label="Run Diagnostics">Diagnostics</a>
          </div>
        </div>
      </div>
    </section>

    <!-- RIGHT: Side column with Notifications + Events and compact panels -->
    <aside>
      <div class="side-stack">
        <!-- Notifications + Events (combined) -->
        <div class="panel" aria-labelledby="alerts-title">
          <h3 id="alerts-title">Notifications &amp; Events</h3>

          <ul class="small-list" aria-live="polite" style="margin-bottom:12px">
            <li class="small-item">
              <div style="flex:1">
                <strong style="color:var(--accent)">No critical alerts</strong>
                <div style="color:var(--text-muted);font-size:0.9rem">All mission-critical systems stable.</div>
              </div>
            </li>

            <li class="small-item">
              <div style="flex:1">
                <strong>Communications</strong>
                <div style="color:var(--text-muted);font-size:0.9rem">Channel: Standby</div>
              </div>
            </li>
          </ul>

          <h4 style="margin:0 0 8px 0;color:var(--text-main)">Upcoming Events</h4>
          <ul class="small-list">
            <li class="small-item">
              <div style="flex:1">
                <strong>Captain Carter's Birthday</strong>
                <div style="color:var(--text-muted);font-size:0.9rem">2026-01-22 â€¢ 17:30 â€” Authorized Personnel Only</div>
              </div>
            </li>
            <li class="small-item">
              <div style="flex:1">
                <strong>Mechanic Nima's Birthday</strong>
                <div style="color:var(--text-muted);font-size:0.9rem">2026-01-22 â€¢ 17:30</div>
              </div>
            </li>
          </ul>
        </div>

        <!-- Photo gallery with larger thumbnails and a lightbox slideshow -->
        <div class="panel" aria-labelledby="gallery-title">
          <h3 id="gallery-title">Photo Gallery</h3>
          <div class="gallery-grid" id="gallery">
            <img class="thumb" data-index="0" src="https://obviouslymelissa-hub.github.io/obsidianbastian/images/ship-1.jpg" alt="Command Deck â€” view 1" tabindex="0" />
            <img class="thumb" data-index="1" src="https://obviouslymelissa-hub.github.io/obsidianbastian/images/ship-2.jpg" alt="Observation Dome â€” view 2" tabindex="0" />
            <img class="thumb" data-index="2" src="https://obviouslymelissa-hub.github.io/obsidianbastian/images/ship-3.jpg" alt="Exterior â€” view 3" tabindex="0" />
          </div>
        </div>
      </div>
    </aside>
  </main>

  <!-- Lightbox / slideshow markup (unchanged) -->
  <div id="lightbox" class="lightbox" aria-hidden="true" role="dialog" aria-modal="true" aria-label="Image viewer">
    <button class="lb-close" id="lbClose" aria-label="Close viewer">&times;</button>
    <button class="lb-prev" id="lbPrev" aria-label="Previous image">â€¹</button>

    <div class="lb-content" role="document">
      <img id="lbImage" src="" alt="">
      <div id="lbCaption" class="lb-caption" aria-live="polite"></div>
    </div>

    <button class="lb-next" id="lbNext" aria-label="Next image">â€º</button>
  </div>

  <footer>
    Â© Family Fleet â€” Obsidian Bastian â€¢ Public homepage
  </footer>

  <!-- Header interactivity + lightbox scripts preserved (unchanged) -->
  <script>/* header parallax / sheen script (unchanged) */ (function () {
      const shipWrap = document.getElementById('shipWrap');
      const shipImg = document.getElementById('shipImg');
      const siteTitle = document.getElementById('siteTitle');
      const reduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      const isTouch = ('ontouchstart' in window) || navigator.maxTouchPoints > 0;
      if (!reduce && !isTouch && shipWrap && shipImg) {
        const maxRotate = 6;
        const maxTranslate = 6;
        function onMove(e) {
          const rect = shipWrap.getBoundingClientRect();
          const cx = rect.left + rect.width / 2;
          const cy = rect.top + rect.height / 2;
          const clientX = e.clientX || (e.touches && e.touches[0].clientX);
          const clientY = e.clientY || (e.touches && e.touches[0].clientY);
          const dx = (clientX - cx) / rect.width;
          const dy = (clientY - cy) / rect.height;
          const rotY = dx * maxRotate;
          const rotX = -dy * maxRotate;
          const tx = dx * maxTranslate;
          const ty = dy * maxTranslate;
          shipWrap.style.transform = `translate3d(${tx}px, ${ty}px, 0) rotateX(${rotX}deg) rotateY(${rotY}deg)`;
          shipImg.style.transform = `scale(1.02) translate3d(${tx * -0.35}px, ${ty * -0.35}px, 0)`;
        }
        function onLeave() { shipWrap.style.transform = ''; shipImg.style.transform = ''; }
        const headerInner = document.querySelector('.header-inner');
        headerInner.addEventListener('mousemove', onMove);
        headerInner.addEventListener('mouseleave', onLeave);
        headerInner.addEventListener('touchmove', onMove, { passive: true });
        headerInner.addEventListener('touchend', onLeave);
      }
      if (!reduce && siteTitle) {
        const triggerSheen = () => { siteTitle.classList.add('sheen'); setTimeout(() => siteTitle.classList.remove('sheen'), 900); };
        setTimeout(triggerSheen, 700);
        setInterval(triggerSheen, 8000);
      }
    })();</script>

  <script>
    (function(){
      const images = [
        { src: 'https://obviouslymelissa-hub.github.io/obsidianbastian/images/ship-1.jpg', caption: 'Command Deck' },
        { src: 'https://obviouslymelissa-hub.github.io/obsidianbastian/images/ship-2.jpg', caption: 'Observation Dome' },
        { src: 'https://obviouslymelissa-hub.github.io/obsidianbastian/images/ship-3.jpg', caption: 'Exterior' }
      ];

      const gallery = document.getElementById('gallery');
      const thumbs = gallery ? Array.from(gallery.querySelectorAll('.thumb')) : [];
      const lightbox = document.getElementById('lightbox');
      const lbImage = document.getElementById('lbImage');
      const lbCaption = document.getElementById('lbCaption');
      const lbClose = document.getElementById('lbClose');
      const lbPrev = document.getElementById('lbPrev');
      const lbNext = document.getElementById('lbNext');

      let current = 0;

      function openLightbox(idx) {
        current = (typeof idx === 'number') ? idx : 0;
        const item = images[current];
        lbImage.src = item.src;
        lbImage.alt = item.caption || '';
        lbCaption.textContent = item.caption || '';
        lightbox.classList.add('open');
        lightbox.setAttribute('aria-hidden', 'false');
        lbClose.focus();
        document.body.style.overflow = 'hidden';
      }

      function closeLightbox() {
        lightbox.classList.remove('open');
        lightbox.setAttribute('aria-hidden', 'true');
        lbImage.src = '';
        lbCaption.textContent = '';
        document.body.style.overflow = '';
        const thumb = thumbs[current];
        if (thumb) thumb.focus();
      }

      function showPrev() {
        current = (current - 1 + images.length) % images.length;
        updateLightbox();
      }
      function showNext() {
        current = (current + 1) % images.length;
        updateLightbox();
      }
      function updateLightbox() {
        const item = images[current];
        lbImage.src = item.src;
        lbImage.alt = item.caption || '';
        lbCaption.textContent = item.caption || '';
      }

      thumbs.forEach(t => {
        t.addEventListener('click', (e) => {
          const idx = Number(t.getAttribute('data-index'));
          openLightbox(idx);
        });
        t.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            const idx = Number(t.getAttribute('data-index'));
            openLightbox(idx);
          }
        });
      });

      lbClose.addEventListener('click', closeLightbox);
      lbPrev.addEventListener('click', showPrev);
      lbNext.addEventListener('click', showNext);

      lightbox.addEventListener('click', (e) => {
        if (e.target === lightbox) closeLightbox();
      });

      document.addEventListener('keydown', (e) => {
        if (!lightbox.classList.contains('open')) return;
        if (e.key === 'Escape') closeLightbox();
        else if (e.key === 'ArrowLeft') showPrev();
        else if (e.key === 'ArrowRight') showNext();
      });

      images.forEach(i => {
        const img = new Image();
        img.src = i.src;
      });
    })();
  </script>
</body>
</html>
